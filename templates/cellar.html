{% extends "base.html" %}
{% block title %}{{ status_label }} - ManageYourCellar.com{% endblock %}

{% block content %}
<!-- Title matching original: "Wines in Cellar" -->
<div class="section-title" style="font-size:13px;"><b>{{ status_label }}</b></div>

<!-- Wine Finder bar matching original layout exactly -->
<div style="padding:2px 0;">
<form method="GET" action="{{ url_for('cellar') }}">
    <input type="hidden" name="status" value="{{ status }}">
    <table class="detail-table" style="margin:0;">
        <tr>
            <td style="white-space:nowrap;padding:1px 3px;">
                <span style="font-size:11px;">Wine Finder</span>
            </td>
            <td style="padding:1px 3px;">
                {{ search_form.query(class="form-control", style="width:200px;display:inline;", placeholder="") }}
            </td>
        </tr>
        <tr>
            <td style="white-space:nowrap;padding:1px 3px;">
                <span style="font-size:11px;">Sorted by</span>
            </td>
            <td style="padding:1px 3px;">
                {{ search_form.sort_by(class="form-control", style="width:auto;display:inline;") }}
                {{ search_form.sort_order(class="form-control", style="width:auto;display:inline;") }}
                &nbsp;
                <span style="font-size:11px;">Type/Color</span>
                {{ search_form.wine_type(class="form-control", style="width:auto;display:inline;") }}
                &nbsp;
                <span style="font-size:11px;">Varietal</span>
                {{ search_form.varietal(class="form-control", style="width:100px;display:inline;", placeholder="Any Varietal") }}
                &nbsp;
                <button type="submit" class="btn btn-secondary" style="padding:1px 10px;">Search</button>
            </td>
        </tr>
    </table>
</form>
</div>

<!-- Page info -->
<div style="font-size:11px;padding:2px 0;display:flex;justify-content:space-between;align-items:center;">
    <span>
        {% if wines %}
        Page 1 of {{ wines|length }} &ndash; {{ wines|sum(attribute='quantity') }} wines
        {% endif %}
    </span>
    <span>
        <a href="{{ url_for('add_wine') }}" style="font-size:10px;">Add Wine</a> |
        <a href="{{ url_for('quick_entry') }}" style="font-size:10px;">Quick Entry</a>
    </span>
</div>

{% if wines %}
<table class="wine-table">
    <thead>
        <tr>
            <th style="text-align:left;"><a href="{{ url_for('cellar', status=status, sort_by='name') }}">Name</a></th>
            <th style="text-align:left;"><a href="{{ url_for('cellar', status=status, sort_by='producer') }}">Producer</a></th>
            <th style="text-align:left;"><a href="{{ url_for('cellar', status=status, sort_by='appellation') }}">Appellation</a></th>
            <th style="text-align:left;"><a href="{{ url_for('cellar', status=status, sort_by='varietal') }}">Varietal</a></th>
            <th>Maturity</th>
            <th><a href="{{ url_for('cellar', status=status, sort_by='rating') }}">Rating</a></th>
            {% if status == 'cellar' %}<th>Storage</th>{% endif %}
            <th style="text-align:right;"><a href="{{ url_for('cellar', status=status, sort_by='price') }}">Est. Price</a></th>
        </tr>
    </thead>
    <tbody>
        {% for wine in wines %}
        <tr>
            <td>
                {% if wine.vintage %}<span style="font-weight:bold;">{{ wine.vintage }}</span><br>{% endif %}
                <a href="{{ url_for('wine_detail', wine_id=wine.id) }}" class="wine-link">{{ wine.name }} ({{ wine.size_ml or 750 }}ml)</a>
                {% if wine.has_rating %}<br><span style="font-size:9px;vertical-align:super;color:#990000;">RATED</span>{% endif %}
            </td>
            <td>{{ wine.producer }}</td>
            <td>{{ wine.appellation or '' }}</td>
            <td>{{ wine.varietals_display or '' }}</td>
            <td style="text-align:center;">{{ wine.maturity_display or '' }}</td>
            <td style="text-align:center;">{{ wine.rating_text }}</td>
            {% if status == 'cellar' %}<td>{{ wine.stored or '' }}</td>{% endif %}
            <td style="text-align:right;">{% if wine.price %}US${{ "%.2f"|format(wine.price) }}{% else %}n/a{% endif %}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="empty-state">
    <p>No wines found. <a href="{{ url_for('add_wine') }}">Add Wine</a> to get started.</p>
</div>
{% endif %}
{% endblock %}
