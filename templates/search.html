{% extends "base.html" %}
{% block title %}Advanced Search - ManageYourCellar.com{% endblock %}

{% block content %}
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr class="header"><td class="title"><b>Advanced Search: Query Wine</b></td></tr>
</table>

<form method="GET" action="{{ url_for('search') }}">
<table cellpadding="3" cellspacing="0" border="0" style="margin:4px 0;">
    <tr>
        <td class="smallfieldlabel" nowrap>Wine Finder:</td>
        <td class="smallfieldvalue">{{ form.query(class="form-control", style="width:300px;", placeholder="Enter keywords") }}</td>
    </tr>
    <tr>
        <td class="smallfieldlabel" nowrap>Sorted by:</td>
        <td class="smallfieldvalue">
            {{ form.sort_by(style="font-size:11px;display:inline;") }}
            {{ form.sort_order(style="font-size:11px;display:inline;") }}
        </td>
    </tr>
    <tr>
        <td class="smallfieldlabel" nowrap>Type/Color:</td>
        <td class="smallfieldvalue">{{ form.wine_type(style="font-size:11px;") }}</td>
    </tr>
    <tr>
        <td class="smallfieldlabel" nowrap>Varietal:</td>
        <td class="smallfieldvalue">{{ form.varietal(class="form-control", style="width:200px;", placeholder="Any Varietal") }}</td>
    </tr>
    <tr>
        <td class="smallfieldlabel" nowrap>Appellation:</td>
        <td class="smallfieldvalue">{{ form.appellation(class="form-control", style="width:200px;", placeholder="Any Appellation") }}</td>
    </tr>
    <tr>
        <td class="smallfieldlabel"></td>
        <td class="smallfieldvalue"><input type="submit" value="Search"></td>
    </tr>
</table>
</form>

{% if wines %}
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr class="header"><td class="title"><b>Search Results: {{ wines|length }} wine{{ 's' if wines|length != 1 }} found</b></td></tr>
</table>

<table cellpadding="2" cellspacing="0" border="0" width="100%">
<tbody>
<tr class="subhead">
    <td style="text-align:left;">Name</td>
    <td style="text-align:left;">Producer</td>
    <td style="text-align:left;">Appellation</td>
    <td style="text-align:left;">Varietal</td>
    <td>Qty</td>
    <td>Maturity</td>
    <td>Rating</td>
    <td style="text-align:right;">Price</td>
</tr>
{% for wine in wines %}
<tr class="{{ 'odditem' if loop.index is odd else 'evenitem' }}">
    <td>
        {% if wine.vintage %}<b>{{ wine.vintage }}</b> {% endif %}<a href="{{ url_for('wine_detail', wine_id=wine.id) }}">{{ wine.name }} ({{ wine.size_ml or 750 }}ml)</a>{% if wine.has_rating %} <span style="font-size:9px;vertical-align:super;color:#990000;font-weight:bold;">RATED</span>{% endif %}
    </td>
    <td>{{ wine.producer }}</td>
    <td>{{ wine.appellation or '' }}</td>
    <td>{{ wine.varietals_display or '' }}</td>
    <td style="text-align:center;">{{ wine.quantity }}</td>
    <td style="text-align:center;">{{ wine.maturity_display or '' }}</td>
    <td style="text-align:center;">{{ wine.rating_text }}</td>
    <td style="text-align:right;white-space:nowrap;">{% if wine.price %}US${{ "%.2f"|format(wine.price) }}{% else %}n/a{% endif %}</td>
</tr>
{% endfor %}
</tbody>
</table>
{% elif form.query.data %}
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr class="header"><td class="title"><b>Advanced Search</b></td></tr>
</table>
<p class="smalltext" style="padding:4px;">No wine was found for your search. Please try a different search below.</p>
{% endif %}
{% endblock %}
