{% extends "base.html" %}
{% block title %}Search - WineCellarManager.com{% endblock %}

{% block content %}
<h1 style="font-size:16px;">Search Your Collection</h1>

<div class="filter-bar">
    <form method="GET" action="{{ url_for('search') }}">
        <div class="filter-row">
            <div class="form-group" style="flex:2;"><label>Search</label>{{ form.query(class="form-control", placeholder="Wine name, producer, varietal...") }}</div>
            <div class="form-group"><label>Type</label>{{ form.wine_type(class="form-control") }}</div>
            <div class="form-group"><label>Appellation</label>{{ form.appellation(class="form-control", placeholder="e.g. Napa Valley") }}</div>
            <div class="form-group"><label>Varietal</label>{{ form.varietal(class="form-control", placeholder="e.g. Pinot Noir") }}</div>
            <div class="form-group" style="flex:0;"><label>&nbsp;</label><button type="submit" class="btn btn-primary">Search</button></div>
        </div>
    </form>
</div>

{% if wines %}
<div class="info-box"><strong>{{ wines|length }}</strong> result{{ 's' if wines|length != 1 }}.</div>
<table class="wine-table"><thead><tr><th>Name</th><th>Vintage</th><th>Producer</th><th>Type</th><th>Appellation</th><th>Varietal</th><th>Status</th><th>Rating</th></tr></thead><tbody>
{% for wine in wines %}<tr>
    <td><a href="{{ url_for('wine_detail', wine_id=wine.id) }}" class="wine-link">{{ wine.name }}</a></td>
    <td>{{ wine.vintage or 'NV' }}</td><td>{{ wine.producer }}</td><td>{{ wine.wine_type }}</td><td>{{ wine.appellation or '-' }}</td><td>{{ wine.varietals_display or '-' }}</td>
    <td>{% if wine.status == 'cellar' %}In Cellar{% elif wine.status == 'consumed' %}Consumed{% elif wine.status == 'wishlist' %}Wish List{% endif %}</td>
    <td>{% if wine.rating %}<span class="wine-tag rating">{{ wine.rating }}</span>{% else %}-{% endif %}</td>
</tr>{% endfor %}
</tbody></table>
{% elif form.query.data %}
<div class="empty-state"><h3>No wines found</h3><p>Try adjusting your search.</p></div>
{% endif %}
{% endblock %}
